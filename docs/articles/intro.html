<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Piggyback Data atop your GitHub Repository! • piggyback</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Piggyback Data atop your GitHub Repository!">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">piggyback</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro.html">Piggyback Data atop your GitHub Repository!</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/cboettig/piggyback">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Piggyback Data atop your GitHub Repository!</h1>
                        <h4 class="author">Carl Boettiger</h4>
            
            <h4 class="date">2018-05-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cboettig/piggyback/blob/master/vignettes/intro.Rmd"><code>vignettes/intro.Rmd</code></a></small>
      <div class="hidden name"><code>intro.Rmd</code></div>

    </div>

    
    
<div id="why-piggyback" class="section level1">
<h1 class="hasAnchor">
<a href="#why-piggyback" class="anchor"></a>Why <code>piggyback</code>?</h1>
<p><code>piggyback</code> grew out of the needs of students both in my classroom and in my research group, who frequently need to work with data files somewhat larger than one can conveniently manage by committing directly to GitHub. As we frequently want to share and run code that depends on &gt;50MB data files on each of our own machines, on continuous integration (i.e. <a href="https://travis.org">travis</a>), and on larger computational servers, data sharing quickly becomes a bottleneck.</p>
<p>Piggyback aims to address this using a <a href="https://git-lfs.github.com/">Git LFS</a> style approach, in which you specify the type of files you wish to track, and then can pull an push data files to GitHub (though not through <code>git</code> itself):</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(piggyback)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co"># track csv files, compressed data, and geotiff files:</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="../reference/pb_track.html">pb_track</a></span>(<span class="kw">c</span>(<span class="st">"*.csv"</span>, <span class="st">"*.gz"</span>, <span class="st">"*.tif"</span>))</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw"><a href="../reference/pb_push.html">pb_push</a></span>()</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">## pull data onto a new machine:</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="kw"><a href="../reference/pb_pull.html">pb_pull</a></span>()</a></code></pre></div>
<p>To authenticate, add your <code>GITHUB_TOKEN</code> to a secure <code>.Renviron</code> file (and <code>.gitignore</code> it!). If you have never created a GitHub token before, use <code><a href="http://www.rdocumentation.org/packages/usethis/topics/browse_github_pat">usethis::browse_github_pat()</a></code> to get started. Note that <code>piggyback</code> can also be used more manually to upload or download individual files to your GitHub repositories:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="../reference/pb_upload.html">pb_upload</a></span>(<span class="st">"my-data.csv"</span>, <span class="dt">repo =</span> <span class="st">"user/repo"</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="../reference/pb_download.html">pb_download</a></span>(<span class="st">"my-data.csv"</span>, <span class="dt">repo =</span> <span class="st">"user/repo"</span>)</a></code></pre></div>
<p>See the README for additional information on basic use.</p>
<div id="piggyback-vs-the-alternatives" class="section level2">
<h2 class="hasAnchor">
<a href="#piggyback-vs-the-alternatives" class="anchor"></a><code>piggyback</code> vs the alternatives</h2>
<p>There are many alternatives to <code>piggyback</code>, and after considerable experience I haven’t found any that ticked all the boxes for me:</p>
<ul>
<li>[x] Free storage</li>
<li>[x] Can be integrated into private code / private workflows</li>
<li>[x] Simple and practical to deploy on continuous integration</li>
<li>[x] Works well with private data</li>
<li>[x] Minimal configuration</li>
</ul>
<div id="git-lfs" class="section level3">
<h3 class="hasAnchor">
<a href="#git-lfs" class="anchor"></a>Git LFS</h3>
<p>Git LFS provides the closest user experience to what I was going for. It stands out above all other alternatives for providing both the <em>best authentication</em> experience (relying directly on any of the standard <code>git</code> authentication mechanisms such as https, ssh keys, app integration), and it provides the most legitimate version control of the data. However, there are many show-stoppers to using Git LFS for me.</p>
<ul>
<li><p>GitHub pricing &amp; resulting problems for GitHub’s fork / PR model. <a href="https://medium.com/@megastep/github-s-large-file-storage-is-no-panacea-for-open-source-quite-the-opposite-12c0e16a9a91">Described eleqouently here</a>. Basically, despite generous rates and free data options everywhere else, GitHub’s LFS storage and bandwidth not only cost a lot, but also make it impossible to have public forks and pull request for your repository. Technically this is a problem only for GitHub’s LFS (since it stems from the pricing rules); and can be avoided by using LFS on GitLab or other platform, as <a href="https://github.com/jimhester/test-glfs/">Jim Hester has described</a>. Still, this proved <a href="https://github.com/jimhester/test-glfs/issues/2">unsuccessful for me</a>, and still faces the other big issue with <code>git-lfs</code>:</p></li>
<li><p>Overwrites <code>git</code> itself. Git LFS is just <em>too</em> integrated into <code>git</code> – it replaces your authentic <code>git</code> engine with <code>git-lfs</code>, such that the identical <code>git</code> command can have different behaviors on a machine with <code>git-lfs</code> installed vs just plain <code>git</code>. Maybe fine for a professional team that is “all in” on <code>git-lfs</code>, but is a constant source of pitfalls when working with students and moving between machines that all have only authentic <code>git</code> installed. The difficulties with supporting pull requests etc are also related to this – in some sense, once you have a <code>git-lfs</code> repository, you’re really using an entirely new version control system that isn’t going to be 100% compatible with the nearly-ubiquitous authentic <code>git</code>.</p></li>
</ul>
</div>
<div id="amazon-s3" class="section level3">
<h3 class="hasAnchor">
<a href="#amazon-s3" class="anchor"></a>Amazon S3</h3>
<p>Amazon S3 is perhaps the most universal and most obvious go-to place for online-available public and private data storage. The 5 GB/mo free tier is nice and the pricing is very reasonable and only very incremental after that. It is easily the most industry-standard solution, and still probably the best way to go in many cases. It is probably the most scalable solution for very large data, and the only such that has built in support/integration to larger query services like Apache Spark / <code>sparklyr</code>. It falls short of my own use case though in the authentication area. I require students create a GitHub account for my courses and my lab group. I don’t like requiring such third-party accounts, but this one is fundamental to our daily use in classroom and in research, and most of them will continue using the service afterwards. I particularly don’t like having people create complex accounts that they might not even use much in the class or afterwards, just to deal with some pesky minor issue of some data file that is just a little too big for GitHub.</p>
<p>Amazon’s authentication is also much more complex than GitHub’s passwords or tokens, as is the process of uploading and downloading data from S3 (though the <code>aws.s3</code> R package is rather nice remedy here, it doesn’t conform to the same user API as the <code>aws-cli</code> (python) tool, leaving some odd quirks and patterns that don’t match standard Linux commands.) Together, these make it significantly more difficult to deploy as a quick solution for moving private data around with private repositories.</p>
</div>
<div id="scientific-repositories-with-private-storage" class="section level3">
<h3 class="hasAnchor">
<a href="#scientific-repositories-with-private-storage" class="anchor"></a>Scientific repositories with private storage</h3>
<p>For scientific research purposes, this would be my ideal solution. Encouraging researchers to submit data to a repository at the time of publication is always a challenge, since doing so inevitably involves time &amp; effort and the immediate benefit to the researcher is relatively minimal. If uploading the data to a repository served an immediate practical purpose of facilitating collaboration, backing up and possibly versioning data, etc, during the research process itself rather than after all is said and done, it would be much more compelling. Several repositories permit sharing of private data, at least up to some threshold, including DataONE and figshare. Unfortunately, at this time, I have found the interfaces and R tooling for these too limited or cumbersome for everyday use.</p>
</div>
<div id="datastorr" class="section level3">
<h3 class="hasAnchor">
<a href="#datastorr" class="anchor"></a><a href="https://github.com/ropenscilabs/datastorr">datastorr</a>
</h3>
<p>The <code>piggyback</code> approach is partly inspired by the strategy used in the <code>datastorr</code> package, which also uploads data to GitHub releases. <code>datastorr</code> envisions a rather different workflow around this storage strategy, based on the concept of an R “data package” rather than the Git LFS. I am not a fan of the “data package” approach in general – I think data should be stored in a platform agnostic way, not as <code>.Rdata</code> files, and I often want to first download my data to disk and read it with dedicated functions, not load it “auto-magically” as a package. This latter issue is particularly important when the data files are larger than what can conveniently fit into working memory, and is better accessed as a database (e.g. SQLite for tabular data, postgis spatial data, etc).</p>
<p>In terms of practical implementation, <code>datastorr</code> also creates a new release every time the data file is updated, rather than letting you overwrite files. In principle <code>piggyback</code> will let you version data this way as well, simply create a new release first using <code><a href="../reference/pb_new_release.html">pb_new_release(tag="v2")</a></code> or whatever tag you like. I have not opted for this workflow since in reality, versioning data with releases this way is technically equivalent to creating a new folder for each new version of the data and storing that – unlike true git commits, release assets such as <code>datastorr</code> creates can be easily deleted or overwritten. I still believe permanent versioned archives like Zenodo should be used for long-term versioned distribution. Meanwhile, for day-to-day use I often want to overwrite data files with their most recent versions. (In my case these ‘data’ files are most often created from upstream data and/or other possibly-long-running code, and are tracked for convenience. As such they often change as a result of continued work on the upstream processing code. Perhaps this is not the case for many users and more attention should be paid to versioning.)</p>
</div>
<div id="sharding-on-github" class="section level3">
<h3 class="hasAnchor">
<a href="#sharding-on-github" class="anchor"></a>Sharding on GitHub</h3>
<p>Another creative solution (hack), at least for some file types, is to break large files into multiple smaller files, and commit those to one or many GitHub repositories. While <a href="https://en.wikipedia.org/wiki/Shard_(database_architecture)">sharding</a> is sometimes a legitimate strategy, it has many obvious practical disadvantages and limitations.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#why-piggyback">Why <code>piggyback</code>?</a><ul class="nav nav-pills nav-stacked">
<li><a href="#piggyback-vs-the-alternatives"><code>piggyback</code> vs the alternatives</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Carl Boettiger.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
